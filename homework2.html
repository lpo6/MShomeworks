<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç»Ÿè®¡æ¨¡æ‹Ÿå™¨</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            display: flex;
            background-color: #f5f7fa;
            color: #333;
            min-height: 100vh;
        }
        
        /* å·¦ä¾§å¯¼èˆªæ æ ·å¼ */
        .sidebar {
            width: 250px;
            background: linear-gradient(135deg, #2c3e50, #4a69bd);
            color: white;
            padding: 20px 0;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
        }
        
        .logo {
            text-align: center;
            padding: 20px;
            margin-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .logo h1 {
            font-size: 1.5rem;
            font-weight: 600;
        }
        
        .nav-links {
            list-style: none;
            flex-grow: 1;
        }
        
        .nav-links li {
            padding: 0;
            margin: 5px 15px;
            border-radius: 5px;
            overflow: hidden;
        }
        
        .nav-links a {
            display: block;
            color: white;
            text-decoration: none;
            padding: 12px 20px;
            border-radius: 5px;
            transition: all 0.3s ease;
        }
        
        .nav-links a:hover, .nav-links a.active {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(5px);
        }
        
        .nav-links i {
            margin-right: 10px;
            width: 20px;
            text-align: center;
        }
        
        .footer {
            text-align: center;
            padding: 20px;
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.6);
        }
        
        /* ä¸»å†…å®¹åŒºæ ·å¼ */
        .main-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }
        
        .simulator-section {
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            padding: 25px;
            margin-bottom: 25px;
            display: none;
        }
        
        .simulator-section.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .section-header {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .section-header h2 {
            font-size: 1.8rem;
            color: #2c3e50;
            margin-bottom: 5px;
        }
        
        .section-header p {
            color: #7f8c8d;
            line-height: 1.6;
        }
        
        /* æ–°çš„å¸ƒå±€ç»“æ„ */
        .controls-container {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        
        .control-group {
            margin-bottom: 15px;
        }
        
        .control-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #34495e;
        }
        
        .control-group input, .control-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
        }
        
        .buttons-container {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .btn {
            padding: 10px 20px;
            background: #4a69bd;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: background 0.3s ease;
        }
        
        .btn:hover {
            background: #3c5aa8;
        }
        
        .btn-secondary {
            background: #95a5a6;
        }
        
        .btn-secondary:hover {
            background: #7f8c8d;
        }
        
        .visualization-container {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .simulator-canvas {
            flex: 1;
            min-width: 400px;
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .chart-container {
            flex: 1;
            min-width: 400px;
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            position: relative;
            height: 400px;
        }
        
        .results {
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #4a69bd;
            margin-top: 20px;
        }
        
        .results h3 {
            margin-bottom: 15px;
            color: #2c3e50;
        }
        
        .result-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .result-item {
            background: white;
            padding: 15px;
            border-radius: 6px;
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.05);
        }
        
        .result-item .label {
            font-size: 0.9rem;
            color: #7f8c8d;
            margin-bottom: 5px;
        }
        
        .result-item .value {
            font-size: 1.2rem;
            font-weight: 600;
            color: #2c3e50;
        }
        
        /* ä¸»é¡µæ ·å¼ */
        .welcome-section {
            text-align: center;
            padding: 40px 20px;
        }
        
        .welcome-section h1 {
            font-size: 2.5rem;
            color: #2c3e50;
            margin-bottom: 20px;
        }
        
        .welcome-section p {
            font-size: 1.1rem;
            color: #7f8c8d;
            max-width: 800px;
            margin: 0 auto 30px;
            line-height: 1.6;
        }
        
        .features {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 30px;
            max-width: 1000px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .feature-card {
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            padding: 25px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        }
        
        .feature-icon {
            font-size: 2.5rem;
            color: #4a69bd;
            margin-bottom: 15px;
        }
        
        .feature-card h3 {
            font-size: 1.3rem;
            margin-bottom: 10px;
            color: #2c3e50;
        }
        
        .feature-card p {
            color: #7f8c8d;
            font-size: 0.95rem;
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 900px) {
            .features {
                grid-template-columns: 1fr;
            }
            
            .visualization-container {
                flex-direction: column;
            }
            
            .simulator-canvas, .chart-container {
                min-width: 100%;
            }
        }
        
        @media (max-width: 768px) {
            body {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                padding: 10px 0;
            }
            
            .nav-links {
                display: flex;
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .nav-links li {
                margin: 5px;
            }
            
            .nav-links a {
                padding: 10px 15px;
            }
            
            .result-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- å·¦ä¾§å¯¼èˆªæ  -->
    <div class="sidebar">
        <div class="logo">
            <h1>ç»Ÿè®¡æ¨¡æ‹Ÿå™¨</h1>
        </div>
        
        <ul class="nav-links">
            <li><a href="#" class="active" data-target="welcome">é¦–é¡µ</a></li>
            <li><a href="#" data-target="buffon">è’²ä¸°æŠ•é’ˆ</a></li>
            <li><a href="#" data-target="galton">é«˜å°”é¡¿é’‰æ¿</a></li>
            <li><a href="#" data-target="birthday">ç”Ÿæ—¥é—®é¢˜</a></li>
            <li><a href="#" data-target="room">åˆ†æˆ¿é—®é¢˜</a></li>
        </ul>
        
        <div class="footer">
            <p>ç»Ÿè®¡æ¨¡æ‹Ÿå®éªŒå¹³å° &copy; 2023</p>
        </div>
    </div>
    
    <!-- ä¸»å†…å®¹åŒº -->
    <div class="main-content">
        <!-- æ¬¢è¿éƒ¨åˆ† -->
        <div id="welcome" class="simulator-section active">
            <div class="welcome-section">
                <h1>ç»Ÿè®¡æ¨¡æ‹Ÿå®éªŒå¹³å°</h1>
                <p>æ¢ç´¢æ¦‚ç‡ä¸ç»Ÿè®¡çš„å¥‡å¦™ä¸–ç•Œï¼æœ¬å¹³å°æä¾›å››ç§ç»å…¸çš„ç»Ÿè®¡æ¨¡æ‹Ÿå®éªŒï¼Œé€šè¿‡äº¤äº’å¼å¯è§†åŒ–å¸®åŠ©æ‚¨ç†è§£å¤æ‚çš„ç»Ÿè®¡æ¦‚å¿µã€‚</p>
                
                <div class="features">
                    <div class="feature-card" data-target="buffon">
                        <div class="feature-icon">ğŸ“Œ</div>
                        <h3>è’²ä¸°æŠ•é’ˆ</h3>
                        <p>é€šè¿‡éšæœºæŠ•é’ˆå®éªŒä¼°ç®—åœ†å‘¨ç‡Ï€çš„å€¼ï¼Œä½“éªŒå‡ ä½•æ¦‚ç‡çš„å¥‡å¦™åº”ç”¨ã€‚</p>
                    </div>
                    
                    <div class="feature-card" data-target="galton">
                        <div class="feature-icon">ğŸ“Š</div>
                        <h3>é«˜å°”é¡¿é’‰æ¿</h3>
                        <p>æ¨¡æ‹Ÿå°çƒé€šè¿‡é’‰æ¿åçš„åˆ†å¸ƒï¼Œç›´è§‚æ¼”ç¤ºæ­£æ€åˆ†å¸ƒçš„å½¢æˆè¿‡ç¨‹ã€‚</p>
                    </div>
                    
                    <div class="feature-card" data-target="birthday">
                        <div class="feature-icon">ğŸ‚</div>
                        <h3>ç”Ÿæ—¥é—®é¢˜</h3>
                        <p>æ¢ç´¢äººç¾¤ä¸­ç”Ÿæ—¥ç›¸åŒçš„æ¦‚ç‡ï¼Œç†è§£åç›´è§‰çš„æ¦‚ç‡ç°è±¡ã€‚</p>
                    </div>
                    
                    <div class="feature-card" data-target="room">
                        <div class="feature-icon">ğŸ¨</div>
                        <h3>åˆ†æˆ¿é—®é¢˜</h3>
                        <p>æ¨¡æ‹Ÿå®¢äººéšæœºå…¥ä½æˆ¿é—´çš„è¿‡ç¨‹ï¼Œç ”ç©¶ occupancy åˆ†å¸ƒé—®é¢˜ã€‚</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- è’²ä¸°æŠ•é’ˆæ¨¡å— -->
        <div id="buffon" class="simulator-section">
            <div class="section-header">
                <h2>è’²ä¸°æŠ•é’ˆå®éªŒ</h2>
                <p>é€šè¿‡éšæœºæŠ•é’ˆå®éªŒæ¥ä¼°ç®—åœ†å‘¨ç‡Ï€çš„å€¼ã€‚å½“é’ˆä¸å¹³è¡Œçº¿ç›¸äº¤æ—¶ï¼Œè®¡æ•°å¢åŠ ï¼Œæ ¹æ®å¤§é‡å®éªŒçš„ç»“æœå¯ä»¥è®¡ç®—å‡ºÏ€çš„è¿‘ä¼¼å€¼ã€‚</p>
            </div>
            
            <!-- å‚æ•°æ§åˆ¶åŒºåŸŸ -->
            <div class="controls-container">
                <div class="control-group">
                    <label for="needleLength">é’ˆçš„é•¿åº¦ (ç›¸å¯¹äºçº¿é—´è·)</label>
                    <input type="range" id="needleLength" min="0.1" max="2" step="0.1" value="1">
                    <span id="needleLengthValue">1.0</span>
                </div>
                
                <div class="control-group">
                    <label for="needleCount">æŠ•é’ˆæ¬¡æ•°</label>
                    <input type="number" id="needleCount" min="1" max="10000" value="100">
                </div>
                
                <div class="control-group">
                    <label for="animationSpeed">åŠ¨ç”»é€Ÿåº¦</label>
                    <select id="animationSpeed">
                        <option value="slow">æ…¢é€Ÿ</option>
                        <option value="medium" selected>ä¸­é€Ÿ</option>
                        <option value="fast">å¿«é€Ÿ</option>
                        <option value="instant">ç«‹å³å®Œæˆ</option>
                    </select>
                </div>
                
                <div class="buttons-container">
                    <button id="startBuffon" class="btn">å¼€å§‹æ¨¡æ‹Ÿ</button>
                    <button id="resetBuffon" class="btn btn-secondary">é‡ç½®</button>
                </div>
            </div>
            
            <!-- å¯è§†åŒ–åŒºåŸŸ -->
            <div class="visualization-container">
                <div class="simulator-canvas">
                    <!-- è’²ä¸°æŠ•é’ˆç”»å¸ƒ -->
                    <canvas id="buffonCanvas" width="500" height="400"></canvas>
                </div>
                
                <div class="chart-container">
                    <!-- è’²ä¸°æŠ•é’ˆç»“æœå›¾è¡¨ -->
                    <canvas id="buffonChart"></canvas>
                </div>
            </div>
            
            <!-- ç»“æœåŒºåŸŸ -->
            <div class="results">
                <h3>æ¨¡æ‹Ÿç»“æœ</h3>
                <div class="result-grid">
                    <div class="result-item">
                        <div class="label">æ€»æŠ•é’ˆæ•°</div>
                        <div class="value" id="totalNeedles">0</div>
                    </div>
                    <div class="result-item">
                        <div class="label">ç›¸äº¤æ¬¡æ•°</div>
                        <div class="value" id="crossings">0</div>
                    </div>
                    <div class="result-item">
                        <div class="label">Ï€çš„ä¼°è®¡å€¼</div>
                        <div class="value" id="piEstimate">0</div>
                    </div>
                    <div class="result-item">
                        <div class="label">è¯¯å·®</div>
                        <div class="value" id="piError">0%</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- é«˜å°”é¡¿é’‰æ¿æ¨¡å— -->
        <div id="galton" class="simulator-section">
            <div class="section-header">
                <h2>é«˜å°”é¡¿é’‰æ¿å®éªŒ</h2>
                <p>æ¨¡æ‹Ÿå°çƒé€šè¿‡å¤šå±‚é’‰æ¿åçš„åˆ†å¸ƒæƒ…å†µï¼Œå±•ç¤ºä¸­å¿ƒæé™å®šç†çš„å®é™…åº”ç”¨ï¼Œä»¥åŠæ­£æ€åˆ†å¸ƒçš„å½¢æˆè¿‡ç¨‹ã€‚</p>
            </div>
            
            <!-- å‚æ•°æ§åˆ¶åŒºåŸŸ -->
            <div class="controls-container">
                <div class="control-group">
                    <label for="boardRows">é’‰æ¿è¡Œæ•°</label>
                    <input type="number" id="boardRows" min="5" max="20" value="10">
                </div>
                
                <div class="control-group">
                    <label for="ballCount">å°çƒæ•°é‡</label>
                    <input type="number" id="ballCount" min="10" max="10000" value="500">
                </div>
                
                <div class="control-group">
                    <label for="galtonAnimationSpeed">åŠ¨ç”»é€Ÿåº¦</label>
                    <select id="galtonAnimationSpeed">
                        <option value="slow">æ…¢é€Ÿ</option>
                        <option value="medium" selected>ä¸­é€Ÿ</option>
                        <option value="fast">å¿«é€Ÿ</option>
                        <option value="instant">ç«‹å³å®Œæˆ</option>
                    </select>
                </div>
                
                <div class="buttons-container">
                    <button id="startGalton" class="btn">å¼€å§‹æ¨¡æ‹Ÿ</button>
                    <button id="resetGalton" class="btn btn-secondary">é‡ç½®</button>
                </div>
            </div>
            
            <!-- å¯è§†åŒ–åŒºåŸŸ -->
            <div class="visualization-container">
                <div class="simulator-canvas">
                    <!-- é«˜å°”é¡¿é’‰æ¿ç”»å¸ƒ -->
                    <canvas id="galtonCanvas" width="500" height="400"></canvas>
                </div>
                
                <div class="chart-container">
                    <!-- é«˜å°”é¡¿é’‰æ¿ç»“æœå›¾è¡¨ -->
                    <canvas id="galtonChart"></canvas>
                </div>
            </div>
            
            <!-- ç»“æœåŒºåŸŸ -->
            <div class="results">
                <h3>æ¨¡æ‹Ÿç»“æœ</h3>
                <div class="result-grid">
                    <div class="result-item">
                        <div class="label">å·²ä¸‹è½å°çƒ</div>
                        <div class="value" id="ballsDropped">0</div>
                    </div>
                    <div class="result-item">
                        <div class="label">åˆ†å¸ƒå½¢çŠ¶</div>
                        <div class="value" id="distributionShape">-</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ç”Ÿæ—¥é—®é¢˜æ¨¡å— -->
        <div id="birthday" class="simulator-section">
            <div class="section-header">
                <h2>ç”Ÿæ—¥é—®é¢˜</h2>
                <p>æ¢ç´¢åœ¨ä¸€ä¸ªç¾¤ä½“ä¸­è‡³å°‘ä¸¤äººå…±äº«åŒä¸€ç”Ÿæ—¥çš„æ¦‚ç‡ã€‚ç»“æœå¾€å¾€æ¯”ç›´è§‰é¢„æœŸçš„è¦é«˜å¾—å¤šï¼Œè¿™æ˜¯ä¸€ä¸ªç»å…¸çš„æ¦‚ç‡æ‚–è®ºã€‚</p>
            </div>
            
            <!-- å‚æ•°æ§åˆ¶åŒºåŸŸ -->
            <div class="controls-container">
                <div class="control-group">
                    <label for="groupSize">ç¾¤ä½“å¤§å°</label>
                    <input type="number" id="groupSize" min="2" max="100" value="23">
                </div>
                
                <div class="control-group">
                    <label for="simulationCount">æ¨¡æ‹Ÿæ¬¡æ•°</label>
                    <input type="number" id="simulationCount" min="10" max="10000" value="100">
                </div>
                
                <div class="buttons-container">
                    <button id="startBirthday" class="btn">å¼€å§‹æ¨¡æ‹Ÿ</button>
                    <button id="resetBirthday" class="btn btn-secondary">é‡ç½®</button>
                </div>
            </div>
            
            <!-- å¯è§†åŒ–åŒºåŸŸ -->
            <div class="visualization-container">
                <div class="simulator-canvas">
                    <!-- ç”Ÿæ—¥é—®é¢˜å¯è§†åŒ– -->
                    <canvas id="birthdayCanvas" width="500" height="400"></canvas>
                </div>
                
                <div class="chart-container">
                    <!-- ç”Ÿæ—¥é—®é¢˜ç»“æœå›¾è¡¨ -->
                    <canvas id="birthdayChart"></canvas>
                </div>
            </div>
            
            <!-- ç»“æœåŒºåŸŸ -->
            <div class="results">
                <h3>æ¨¡æ‹Ÿç»“æœ</h3>
                <div class="result-grid">
                    <div class="result-item">
                        <div class="label">æ¨¡æ‹Ÿæ¬¡æ•°</div>
                        <div class="value" id="simulationsRun">0</div>
                    </div>
                    <div class="result-item">
                        <div class="label">æœ‰ç›¸åŒç”Ÿæ—¥çš„æ¯”ä¾‹</div>
                        <div class="value" id="sameBirthdayRatio">0%</div>
                    </div>
                    <div class="result-item">
                        <div class="label">ç†è®ºæ¦‚ç‡</div>
                        <div class="value" id="theoreticalProbability">0%</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- åˆ†æˆ¿é—®é¢˜æ¨¡å— -->
        <div id="room" class="simulator-section">
            <div class="section-header">
                <h2>åˆ†æˆ¿é—®é¢˜</h2>
                <p>æ¨¡æ‹Ÿå®¢äººéšæœºé€‰æ‹©æˆ¿é—´çš„è¿‡ç¨‹ï¼Œç ”ç©¶æˆ¿é—´å ç”¨åˆ†å¸ƒã€‚ä¹Ÿç§°ä¸º" occupancy problem"ï¼Œæ˜¯æ¦‚ç‡è®ºä¸­çš„ç»å…¸é—®é¢˜ã€‚</p>
            </div>
            
            <!-- å‚æ•°æ§åˆ¶åŒºåŸŸ -->
            <div class="controls-container">
                <div class="control-group">
                    <label for="roomCount">æˆ¿é—´æ•°é‡</label>
                    <input type="number" id="roomCount" min="10" max="1000" value="100">
                </div>
                
                <div class="control-group">
                    <label for="guestCount">å®¢äººæ•°é‡</label>
                    <input type="number" id="guestCount" min="10" max="10000" value="200">
                </div>
                
                <div class="control-group">
                    <label for="preset">é¢„è®¾åœºæ™¯</label>
                    <select id="preset">
                        <option value="custom">è‡ªå®šä¹‰</option>
                        <option value="birthday">ç”Ÿæ—¥é—®é¢˜ç±»ä¼¼ (n=23, k=365)</option>
                        <option value="coupon">ä¼˜æƒ åˆ¸æ”¶é›†é—®é¢˜ (n=å®Œæ•´é›†)</option>
                        <option value="hash">å“ˆå¸Œå†²çª (n=å…ƒç´ , k=æ¡¶)</option>
                    </select>
                </div>
                
                <div class="buttons-container">
                    <button id="startRoom" class="btn">å¼€å§‹æ¨¡æ‹Ÿ</button>
                    <button id="resetRoom" class="btn btn-secondary">é‡ç½®</button>
                </div>
            </div>
            
            <!-- å¯è§†åŒ–åŒºåŸŸ -->
            <div class="visualization-container">
                <div class="simulator-canvas">
                    <!-- åˆ†æˆ¿é—®é¢˜å¯è§†åŒ– -->
                    <canvas id="roomCanvas" width="500" height="400"></canvas>
                </div>
                
                <div class="chart-container">
                    <!-- åˆ†æˆ¿é—®é¢˜ç»“æœå›¾è¡¨ -->
                    <canvas id="roomChart"></canvas>
                </div>
            </div>
            
            <!-- ç»“æœåŒºåŸŸ -->
            <div class="results">
                <h3>æ¨¡æ‹Ÿç»“æœ</h3>
                <div class="result-grid">
                    <div class="result-item">
                        <div class="label">ç©ºæˆ¿é—´æ•°</div>
                        <div class="value" id="emptyRooms">0</div>
                    </div>
                    <div class="result-item">
                        <div class="label">æœ€å¤šå®¢äººçš„æˆ¿é—´</div>
                        <div class="value" id="maxGuests">0</div>
                    </div>
                    <div class="result-item">
                        <div class="label">å¹³å‡æ¯æˆ¿å®¢äººæ•°</div>
                        <div class="value" id="avgGuests">0</div>
                    </div>
                    <div class="result-item">
                        <div class="label">åˆ†å¸ƒç±»å‹</div>
                        <div class="value" id="distributionType">-</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // å¯¼èˆªåŠŸèƒ½
        document.querySelectorAll('.nav-links a, .feature-card').forEach(element => {
            element.addEventListener('click', function(e) {
                e.preventDefault();
                
                const targetId = this.getAttribute('data-target');
                
                // æ›´æ–°æ´»åŠ¨é“¾æ¥
                document.querySelectorAll('.nav-links a').forEach(l => {
                    if (l.getAttribute('data-target') === targetId) {
                        l.classList.add('active');
                    } else {
                        l.classList.remove('active');
                    }
                });
                
                // æ˜¾ç¤ºå¯¹åº”éƒ¨åˆ†
                document.querySelectorAll('.simulator-section').forEach(section => {
                    section.classList.remove('active');
                });
                document.getElementById(targetId).classList.add('active');
                
                // æ»šåŠ¨åˆ°é¡¶éƒ¨
                window.scrollTo(0, 0);
            });
        });
        
        // è’²ä¸°æŠ•é’ˆæ»‘å—å€¼æ˜¾ç¤º
        const needleLengthSlider = document.getElementById('needleLength');
        const needleLengthValue = document.getElementById('needleLengthValue');
        
        if (needleLengthSlider && needleLengthValue) {
            needleLengthSlider.addEventListener('input', function() {
                needleLengthValue.textContent = this.value;
            });
        }
        
        // åˆå§‹åŒ–æ‰€æœ‰å›¾è¡¨
    const initCharts = () => {
    // è’²ä¸°æŠ•é’ˆå›¾è¡¨
    const buffonCtx = document.getElementById('buffonChart');
    if (buffonCtx) {
        window.buffonChart = new Chart(buffonCtx.getContext('2d'), {
            type: 'line',
            data: {
                labels: [],
                datasets: [{
                    label: 'Ï€ä¼°è®¡å€¼',
                    data: [],
                    borderColor: '#4a69bd',
                    backgroundColor: 'rgba(74, 105, 189, 0.1)',
                    tension: 0.1,
                    fill: true
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: 'Ï€ä¼°è®¡å€¼éšæŠ•é’ˆæ¬¡æ•°çš„å˜åŒ–'
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return `Ï€ â‰ˆ ${context.raw.toFixed(4)}`;
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        title: {
                            display: true,
                            text: 'Ï€ä¼°è®¡å€¼'
                        },
                        suggestedMin: 2.5,
                        suggestedMax: 3.5
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'æŠ•é’ˆæ¬¡æ•°'
                        }
                    }
                }
            }
        });
    }
    
    // é«˜å°”é¡¿é’‰æ¿å›¾è¡¨
    const galtonCtx = document.getElementById('galtonChart');
    if (galtonCtx) {
        window.galtonChart = new Chart(galtonCtx.getContext('2d'), {
            type: 'bar',
            data: {
                labels: [],
                datasets: [{
                    label: 'å°çƒæ•°é‡',
                    data: [],
                    backgroundColor: '#4a69bd',
                    borderColor: '#2c3e50',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: 'å°çƒåˆ†å¸ƒç›´æ–¹å›¾'
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'å°çƒæ•°é‡'
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'æ§½ä½'
                        }
                    }
                }
            }
        });
    }
    
    // ç”Ÿæ—¥é—®é¢˜å›¾è¡¨
    const birthdayCtx = document.getElementById('birthdayChart');
    if (birthdayCtx) {
        window.birthdayChart = new Chart(birthdayCtx.getContext('2d'), {
            type: 'line',
            data: {
                labels: [],
                datasets: [
                    {
                        label: 'æ¨¡æ‹Ÿæ¦‚ç‡',
                        data: [],
                        borderColor: '#4a69bd',
                        backgroundColor: 'rgba(74, 105, 189, 0.1)',
                        tension: 0.2,
                        fill: true
                    },
                    {
                        label: 'ç†è®ºæ¦‚ç‡',
                        data: [],
                        borderColor: '#e74c3c',
                        borderDash: [5, 5],
                        tension: 0.2,
                        fill: false
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: 'ç”Ÿæ—¥ç›¸åŒæ¦‚ç‡éšç¾¤ä½“å¤§å°çš„å˜åŒ–'
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return `${context.dataset.label}: ${(context.raw * 100).toFixed(2)}%`;
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        min: 0,
                        max: 1,
                        title: {
                            display: true,
                            text: 'æ¦‚ç‡'
                        },
                        ticks: {
                            callback: function(value) {
                                return (value * 100) + '%';
                            }
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'ç¾¤ä½“å¤§å°'
                        }
                    }
                }
            }
        });
    }
    
    // åˆ†æˆ¿é—®é¢˜å›¾è¡¨
    const roomCtx = document.getElementById('roomChart');
    if (roomCtx) {
        window.roomChart = new Chart(roomCtx.getContext('2d'), {
            type: 'bar',
            data: {
                labels: [],
                datasets: [{
                    label: 'æˆ¿é—´æ•°é‡',
                    data: [],
                    backgroundColor: '#4a69bd',
                    borderColor: '#2c3e50',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: 'æˆ¿é—´å ç”¨åˆ†å¸ƒ'
                    },
                    tooltip: {
                        callbacks: {
                            title: function(context) {
                                return `å ç”¨ ${context[0].label} ä½å®¢äººçš„æˆ¿é—´`;
                            },
                            label: function(context) {
                                return `æ•°é‡: ${context.raw}`;
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'æˆ¿é—´æ•°é‡'
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'å®¢äººæ•°é‡'
                        }
                    }
                }
            }
        });
    }
};
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        window.addEventListener('load', initCharts);
        
        // è¿™é‡Œå°†æ·»åŠ å„æ¨¡æ‹Ÿå™¨çš„å…·ä½“å®ç°ä»£ç 
        // åŒ…æ‹¬åŠ¨ç”»æ§åˆ¶ã€ç”»å¸ƒç»˜åˆ¶ã€è®¡ç®—ç»“æœå’Œæ›´æ–°å›¾è¡¨ç­‰åŠŸèƒ½
        
        /* 
        // è’²ä¸°æŠ•é’ˆå®ç°ä»£ç å°†æ”¾åœ¨è¿™é‡Œ
        
        // é«˜å°”é¡¿é’‰æ¿å®ç°ä»£ç å°†æ”¾åœ¨è¿™é‡Œ
        
        // ç”Ÿæ—¥é—®é¢˜å®ç°ä»£ç å°†æ”¾åœ¨è¿™é‡Œ
        
        // åˆ†æˆ¿é—®é¢˜å®ç°ä»£ç å°†æ”¾åœ¨è¿™é‡Œ
        */
       // è’²ä¸°æŠ•é’ˆå®ç°ä»£ç 
const buffonCanvas = document.getElementById('buffonCanvas');
const buffonCtx = buffonCanvas.getContext('2d');
let buffonAnimationId = null;
let buffonNeedles = [];
let buffonResults = {
    total: 0,
    crossings: 0,
    piEstimates: []
};

function drawBuffonLines() {
    const spacing = buffonCanvas.height / 10;
    buffonCtx.strokeStyle = '#3498db';
    buffonCtx.lineWidth = 1;
    
    for (let i = 0; i <= 10; i++) {
        const y = i * spacing;
        buffonCtx.beginPath();
        buffonCtx.moveTo(0, y);
        buffonCtx.lineTo(buffonCanvas.width, y);
        buffonCtx.stroke();
    }
}

function drawNeedle(needle) {
    buffonCtx.save();
    buffonCtx.translate(needle.x, needle.y);
    buffonCtx.rotate(needle.angle);
    
    buffonCtx.strokeStyle = needle.crosses ? '#e74c3c' : '#2ecc71';
    buffonCtx.lineWidth = 2;
    
    buffonCtx.beginPath();
    buffonCtx.moveTo(-needle.length / 2, 0);
    buffonCtx.lineTo(needle.length / 2, 0);
    buffonCtx.stroke();
    
    buffonCtx.restore();
}

function drawAllNeedles() {
    buffonCtx.clearRect(0, 0, buffonCanvas.width, buffonCanvas.height);
    drawBuffonLines();
    buffonNeedles.forEach(drawNeedle);
}

function dropNeedle() {
    const needleLength = parseFloat(document.getElementById('needleLength').value);
    const spacing = buffonCanvas.height / 10;
    const actualLength = spacing * needleLength;
    
    const x = Math.random() * buffonCanvas.width;
    const y = Math.random() * buffonCanvas.height;
    const angle = Math.random() * Math.PI;
    
    // æ£€æŸ¥æ˜¯å¦ä¸çº¿ç›¸äº¤
    const minY = y - Math.abs(Math.sin(angle) * actualLength / 2);
    const maxY = y + Math.abs(Math.sin(angle) * actualLength / 2);
    
    let crosses = false;
    for (let i = 0; i <= 10; i++) {
        const lineY = i * spacing;
        if (minY <= lineY && maxY >= lineY) {
            crosses = true;
            break;
        }
    }
    
    const needle = { x, y, angle, length: actualLength, crosses };
    buffonNeedles.push(needle);
    
    buffonResults.total++;
    if (crosses) buffonResults.crossings++;
    
    const piEstimate = buffonResults.total > 0 ? 
        (2 * needleLength * buffonResults.total) / buffonResults.crossings : 0;
    buffonResults.piEstimates.push(piEstimate);
    
    // æ›´æ–°UI
    document.getElementById('totalNeedles').textContent = buffonResults.total;
    document.getElementById('crossings').textContent = buffonResults.crossings;
    document.getElementById('piEstimate').textContent = piEstimate.toFixed(6);
    document.getElementById('piError').textContent = 
        Math.abs((Math.PI - piEstimate) / Math.PI * 100).toFixed(4) + '%';
    
    // æ›´æ–°å›¾è¡¨
    if (window.buffonChart) {
        window.buffonChart.data.labels.push(buffonResults.total.toString());
        window.buffonChart.data.datasets[0].data.push(piEstimate);
        window.buffonChart.update();
    }
    
    drawAllNeedles();
    return buffonResults.total < parseInt(document.getElementById('needleCount').value);
}

function startBuffonSimulation() {
    const speed = document.getElementById('animationSpeed').value;
    const speeds = { slow: 500, medium: 100, fast: 20, instant: 0 };
    const delay = speeds[speed];
    
    if (delay === 0) {
        // ç«‹å³å®Œæˆ
        const total = parseInt(document.getElementById('needleCount').value);
        for (let i = 0; i < total; i++) {
            dropNeedle();
        }
    } else {
        // åŠ¨ç”»æ¨¡å¼
        function animate() {
            const continueAnimation = dropNeedle();
            if (continueAnimation) {
                buffonAnimationId = setTimeout(animate, delay);
            }
        }
        animate();
    }
}

function resetBuffonSimulation() {
    if (buffonAnimationId) {
        clearTimeout(buffonAnimationId);
        buffonAnimationId = null;
    }
    
    buffonNeedles = [];
    buffonResults = { total: 0, crossings: 0, piEstimates: [] };
    
    document.getElementById('totalNeedles').textContent = '0';
    document.getElementById('crossings').textContent = '0';
    document.getElementById('piEstimate').textContent = '0';
    document.getElementById('piError').textContent = '0%';
    
    if (window.buffonChart) {
        window.buffonChart.data.labels = [];
        window.buffonChart.data.datasets[0].data = [];
        window.buffonChart.update();
    }
    
    drawAllNeedles();
}

// åˆå§‹åŒ–è’²ä¸°æŠ•é’ˆ
drawBuffonLines();

// é«˜å°”é¡¿é’‰æ¿å®ç°ä»£ç 
const galtonCanvas = document.getElementById('galtonCanvas');
const galtonCtx = galtonCanvas.getContext('2d');
let galtonAnimationId = null;
let galtonResults = {
    ballsDropped: 0,
    distribution: []
};

function drawGaltonBoard() {
    const rows = parseInt(document.getElementById('boardRows').value);
    const cols = rows;
    const spacing = Math.min(galtonCanvas.width, galtonCanvas.height) / (rows + 2);
    
    galtonCtx.clearRect(0, 0, galtonCanvas.width, galtonCanvas.height);
    
    // ç»˜åˆ¶é’‰å­
    galtonCtx.fillStyle = '#2c3e50';
    for (let row = 0; row < rows; row++) {
        const y = (row + 1) * spacing;
        const offset = (galtonCanvas.width - (row + 1) * spacing) / 2;
        
        for (let col = 0; col <= row; col++) {
            const x = offset + col * spacing + spacing / 2;
            galtonCtx.beginPath();
            galtonCtx.arc(x, y, 3, 0, Math.PI * 2);
            galtonCtx.fill();
        }
    }
    
    // ç»˜åˆ¶æ§½ä½
    const slotWidth = spacing;
    const slotHeight = 20;
    const slotTop = galtonCanvas.height - slotHeight;
    
    galtonCtx.fillStyle = '#ecf0f1';
    for (let i = 0; i <= rows; i++) {
        const x = (galtonCanvas.width - (rows + 1) * slotWidth) / 2 + i * slotWidth;
        galtonCtx.fillRect(x, slotTop, slotWidth, slotHeight);
    }
    
    // ç»˜åˆ¶åˆ†å¸ƒ
    if (galtonResults.distribution.length > 0) {
        const maxBalls = Math.max(...galtonResults.distribution);
        galtonCtx.fillStyle = '#4a69bd';
        
        for (let i = 0; i < galtonResults.distribution.length; i++) {
            const x = (galtonCanvas.width - (rows + 1) * slotWidth) / 2 + i * slotWidth;
            const height = (galtonResults.distribution[i] / maxBalls) * (slotTop - rows * spacing);
            galtonCtx.fillRect(x + 2, slotTop - height, slotWidth - 4, height);
        }
    }
}

function dropBall() {
    const rows = parseInt(document.getElementById('boardRows').value);
    let position = 0;
    
    for (let i = 0; i < rows; i++) {
        position += Math.random() > 0.5 ? 0.5 : -0.5;
    }
    
    const slot = Math.round((position + rows / 2) * 2) / 2;
    const normalizedSlot = Math.min(Math.max(slot, 0), rows);
    
    if (!galtonResults.distribution[normalizedSlot]) {
        galtonResults.distribution[normalizedSlot] = 0;
    }
    galtonResults.distribution[normalizedSlot]++;
    galtonResults.ballsDropped++;
    
    // æ›´æ–°UI
    document.getElementById('ballsDropped').textContent = galtonResults.ballsDropped;
    
    // æ›´æ–°å›¾è¡¨
    if (window.galtonChart) {
        const labels = Array.from({length: rows + 1}, (_, i) => i.toString());
        window.galtonChart.data.labels = labels;
        window.galtonChart.data.datasets[0].data = labels.map((_, i) => galtonResults.distribution[i] || 0);
        window.galtonChart.update();
    }
    
    drawGaltonBoard();
    return galtonResults.ballsDropped < parseInt(document.getElementById('ballCount').value);
}

function startGaltonSimulation() {
    const speed = document.getElementById('galtonAnimationSpeed').value;
    const speeds = { slow: 200, medium: 50, fast: 10, instant: 0 };
    const delay = speeds[speed];
    
    if (delay === 0) {
        // ç«‹å³å®Œæˆ
        const total = parseInt(document.getElementById('ballCount').value);
        for (let i = 0; i < total; i++) {
            dropBall();
        }
    } else {
        // åŠ¨ç”»æ¨¡å¼
        function animate() {
            const continueAnimation = dropBall();
            if (continueAnimation) {
                galtonAnimationId = setTimeout(animate, delay);
            }
        }
        animate();
    }
}

function resetGaltonSimulation() {
    if (galtonAnimationId) {
        clearTimeout(galtonAnimationId);
        galtonAnimationId = null;
    }
    
    galtonResults = {
        ballsDropped: 0,
        distribution: []
    };
    
    document.getElementById('ballsDropped').textContent = '0';
    document.getElementById('distributionShape').textContent = '-';
    
    if (window.galtonChart) {
        window.galtonChart.data.labels = [];
        window.galtonChart.data.datasets[0].data = [];
        window.galtonChart.update();
    }
    
    drawGaltonBoard();
}

// åˆå§‹åŒ–é«˜å°”é¡¿é’‰æ¿
drawGaltonBoard();

// ç”Ÿæ—¥é—®é¢˜å®ç°ä»£ç 
const birthdayCanvas = document.getElementById('birthdayCanvas');
const birthdayCtx = birthdayCanvas.getContext('2d');
let birthdayResults = {
    simulations: 0,
    matches: 0,
    probabilities: []
};

function simulateBirthday() {
    const groupSize = parseInt(document.getElementById('groupSize').value);
    const birthdays = new Set();
    let hasMatch = false;
    
    for (let i = 0; i < groupSize; i++) {
        const day = Math.floor(Math.random() * 365) + 1;
        if (birthdays.has(day)) {
            hasMatch = true;
            break;
        }
        birthdays.add(day);
    }
    
    birthdayResults.simulations++;
    if (hasMatch) birthdayResults.matches++;
    
    const probability = birthdayResults.matches / birthdayResults.simulations;
    birthdayResults.probabilities.push(probability);
    
    // è®¡ç®—ç†è®ºæ¦‚ç‡
    let theoretical = 1;
    for (let i = 1; i < groupSize; i++) {
        theoretical *= (365 - i) / 365;
    }
    theoretical = 1 - theoretical;
    
    // æ›´æ–°UI
    document.getElementById('simulationsRun').textContent = birthdayResults.simulations;
    document.getElementById('sameBirthdayRatio').textContent = (probability * 100).toFixed(2) + '%';
    document.getElementById('theoreticalProbability').textContent = (theoretical * 100).toFixed(2) + '%';
    
    // æ›´æ–°å›¾è¡¨
    if (window.birthdayChart) {
        if (!window.birthdayChart.data.labels.includes(groupSize.toString())) {
            window.birthdayChart.data.labels.push(groupSize.toString());
            window.birthdayChart.data.datasets[0].data.push(probability);
            window.birthdayChart.data.datasets[1].data.push(theoretical);
        } else {
            const index = window.birthdayChart.data.labels.indexOf(groupSize.toString());
            window.birthdayChart.data.datasets[0].data[index] = probability;
        }
        window.birthdayChart.update();
    }
    
    drawBirthdayVisualization(birthdays, hasMatch);
    return birthdayResults.simulations < parseInt(document.getElementById('simulationCount').value);
}

function drawBirthdayVisualization(birthdays, hasMatch) {
    birthdayCtx.clearRect(0, 0, birthdayCanvas.width, birthdayCanvas.height);
    
    // ç»˜åˆ¶æ—¥å†
    const days = Array.from(birthdays);
    const cellSize = 15;
    const cols = 31;
    const rows = 12;
    
    birthdayCtx.strokeStyle = '#bdc3c7';
    birthdayCtx.fillStyle = hasMatch ? '#e74c3c' : '#2ecc71';
    
    for (let i = 0; i < days.length; i++) {
        const day = days[i];
        const month = Math.ceil(day / 31) - 1;
        const dayOfMonth = day % 31 || 31;
        
        const x = (dayOfMonth - 1) * cellSize;
        const y = month * cellSize;
        
        birthdayCtx.fillRect(x, y, cellSize - 1, cellSize - 1);
    }
    
    birthdayCtx.fillStyle = '#34495e';
    birthdayCtx.font = '10px Arial';
    birthdayCtx.textAlign = 'center';
    birthdayCtx.textBaseline = 'middle';
    
    for (let month = 0; month < rows; month++) {
        for (let day = 0; day < cols; day++) {
            const x = day * cellSize + cellSize / 2;
            const y = month * cellSize + cellSize / 2;
            
            if (day < 28 || (month !== 1 && day < 31)) {
                birthdayCtx.fillText((day + 1).toString(), x, y);
            }
        }
    }
}

function startBirthdaySimulation() {
    const total = parseInt(document.getElementById('simulationCount').value);
    
    for (let i = 0; i < total; i++) {
        simulateBirthday();
    }
}

function resetBirthdaySimulation() {
    birthdayResults = {
        simulations: 0,
        matches: 0,
        probabilities: []
    };
    
    document.getElementById('simulationsRun').textContent = '0';
    document.getElementById('sameBirthdayRatio').textContent = '0%';
    document.getElementById('theoreticalProbability').textContent = '0%';
    
    if (window.birthdayChart) {
        window.birthdayChart.data.labels = [];
        window.birthdayChart.data.datasets[0].data = [];
        window.birthdayChart.data.datasets[1].data = [];
        window.birthdayChart.update();
    }
    
    birthdayCtx.clearRect(0, 0, birthdayCanvas.width, birthdayCanvas.height);
}

// åˆ†æˆ¿é—®é¢˜å®ç°ä»£ç 
const roomCanvas = document.getElementById('roomCanvas');
const roomCtx = roomCanvas.getContext('2d');
let roomResults = {
    rooms: [],
    distribution: []
};

function simulateRoomAssignment() {
    const roomCount = parseInt(document.getElementById('roomCount').value);
    const guestCount = parseInt(document.getElementById('guestCount').value);
    
    // åˆå§‹åŒ–æˆ¿é—´
    roomResults.rooms = Array(roomCount).fill(0);
    roomResults.distribution = Array(guestCount + 1).fill(0);
    
    // åˆ†é…å®¢äºº
    for (let i = 0; i < guestCount; i++) {
        const room = Math.floor(Math.random() * roomCount);
        roomResults.rooms[room]++;
    }
    
    // è®¡ç®—åˆ†å¸ƒ
    roomResults.rooms.forEach(guests => {
        roomResults.distribution[guests] = (roomResults.distribution[guests] || 0) + 1;
    });
    
    // è®¡ç®—ç»“æœ
    const emptyRooms = roomResults.rooms.filter(g => g === 0).length;
    const maxGuests = Math.max(...roomResults.rooms);
    const avgGuests = guestCount / roomCount;
    
    // ç¡®å®šåˆ†å¸ƒç±»å‹
    let distributionType = 'è¿‘ä¼¼å‡åŒ€åˆ†å¸ƒ';
    if (guestCount / roomCount < 0.1) {
        distributionType = 'è¿‘ä¼¼æ³Šæ¾åˆ†å¸ƒ';
    } else if (guestCount / roomCount > 10) {
        distributionType = 'è¿‘ä¼¼æ­£æ€åˆ†å¸ƒ';
    }
    
    // æ›´æ–°UI
    document.getElementById('emptyRooms').textContent = emptyRooms;
    document.getElementById('maxGuests').textContent = maxGuests;
    document.getElementById('avgGuests').textContent = avgGuests.toFixed(2);
    document.getElementById('distributionType').textContent = distributionType;
    
    // æ›´æ–°å›¾è¡¨
    if (window.roomChart) {
        const maxDisplay = Math.min(20, maxGuests); // é™åˆ¶æ˜¾ç¤ºèŒƒå›´
        const labels = Array.from({length: maxDisplay + 1}, (_, i) => i.toString());
        const data = labels.map((_, i) => roomResults.distribution[i] || 0);
        
        window.roomChart.data.labels = labels;
        window.roomChart.data.datasets[0].data = data;
        window.roomChart.update();
    }
    
    drawRoomVisualization();
}

function drawRoomVisualization() {
    roomCtx.clearRect(0, 0, roomCanvas.width, roomCanvas.height);
    
    const roomCount = roomResults.rooms.length;
    const cols = Math.ceil(Math.sqrt(roomCount));
    const rows = Math.ceil(roomCount / cols);
    const cellSize = Math.min(roomCanvas.width / cols, roomCanvas.height / rows);
    
    const maxGuests = Math.max(...roomResults.rooms);
    
    roomResults.rooms.forEach((guests, index) => {
        const col = index % cols;
        const row = Math.floor(index / cols);
        
        const x = col * cellSize;
        const y = row * cellSize;
        
        // ç»˜åˆ¶æˆ¿é—´
        roomCtx.strokeStyle = '#bdc3c7';
        roomCtx.strokeRect(x, y, cellSize, cellSize);
        
        // ç»˜åˆ¶å®¢äºº
        if (guests > 0) {
            const intensity = Math.min(1, guests / maxGuests);
            roomCtx.fillStyle = `rgba(74, 105, 189, ${0.3 + 0.7 * intensity})`;
            roomCtx.fillRect(x, y, cellSize, cellSize);
            
            roomCtx.fillStyle = '#2c3e50';
            roomCtx.font = '12px Arial';
            roomCtx.textAlign = 'center';
            roomCtx.textBaseline = 'middle';
            roomCtx.fillText(guests.toString(), x + cellSize / 2, y + cellSize / 2);
        }
    });
}

function startRoomSimulation() {
    simulateRoomAssignment();
}

function resetRoomSimulation() {
    roomResults = {
        rooms: [],
        distribution: []
    };
    
    document.getElementById('emptyRooms').textContent = '0';
    document.getElementById('maxGuests').textContent = '0';
    document.getElementById('avgGuests').textContent = '0';
    document.getElementById('distributionType').textContent = '-';
    
    if (window.roomChart) {
        window.roomChart.data.labels = [];
        window.roomChart.data.datasets[0].data = [];
        window.roomChart.update();
    }
    
    roomCtx.clearRect(0, 0, roomCanvas.width, roomCanvas.height);
}
// é¢„è®¾åœºæ™¯å¤„ç†
document.getElementById('preset').addEventListener('change', function() {
    const preset = this.value;
    
    switch(preset) {
        case 'birthday':
            document.getElementById('roomCount').value = 365;
            document.getElementById('guestCount').value = 23;
            break;
        case 'coupon':
            document.getElementById('roomCount').value = 100;
            document.getElementById('guestCount').value = 600;
            break;
        case 'hash':
            document.getElementById('roomCount').value = 100;
            document.getElementById('guestCount').value = 80;
            break;
    }
});

// ç»‘å®šæŒ‰é’®äº‹ä»¶
document.getElementById('startBuffon').addEventListener('click', startBuffonSimulation);
document.getElementById('resetBuffon').addEventListener('click', resetBuffonSimulation);
document.getElementById('startGalton').addEventListener('click', startGaltonSimulation);
document.getElementById('resetGalton').addEventListener('click', resetGaltonSimulation);
document.getElementById('startBirthday').addEventListener('click', startBirthdaySimulation);
document.getElementById('resetBirthday').addEventListener('click', resetBirthdaySimulation);
document.getElementById('startRoom').addEventListener('click', startRoomSimulation);
document.getElementById('resetRoom').addEventListener('click', resetRoomSimulation);
    </script>
</body>
</html>